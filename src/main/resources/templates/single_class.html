<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" >
    <title th:text="${currentSchoolClass.className} + ' - ' + ${currentSchoolClass.subject}"></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script th:src="@{/js/actions.js}"></script>
    <link th:href="@{/css/styles.css}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">

</head>
<body>
<h1 th:data-id="${currentSchoolClass.Id}" th:data-classname="${currentSchoolClass.className}" th:data-subject="${currentSchoolClass.subject}" th:text="${currentSchoolClass.className} + ' - ' + ${currentSchoolClass.subject}"></h1>
<button onclick="openSchoolClassEdit()">Name / Fach ändern</button>
<div id="editSchoolClass">
    <label for="">Klasse:</label>
    <input type="text" id="className">
    <label for="">Fach:</label>
    <input type="text" id="subject">
    <button th:onclick="'updateSchoolClass(' + ${currentSchoolClass.Id} + ')'">ändern</button>
</div>
    <section id="overview">
        <div>
            <p th:text="'Schüler: ' + ${#lists.size(currentSchoolClass.students)}">Schüler: 14</p>
            <p>Noten</p>
            <ul>
               <p th:text="'schriftlich: ' + ${#lists.size(writtenGradeTests)}">schriftlich: 2</p>
               <p th:text="'mündlich: ' + ${#lists.size(oralGradeTests)}">mündlich: 1</p>

            </ul>
        </div>
        <div>
            <button onclick="window.location.href=window.location.href + '/students'">Klassenliste anzeigen</button><br/>
            <button onclick="showHelperContent()">Note anlegen</button>
        </div>
        <div id="helpercontent">
            <h3>Neue Note</h3>
            <form method="POST" th:action="@{/schoolclasses/{id}/newgradetest(id=${currentSchoolClass.Id})}" th:object="${newGradeTest}">
                <input type="radio" th:field="*{gradeType}" id="written" name="grade_type" value="WRITTEN">
                <label for="written">schriftlich</label>
                <input type="radio" th:field="*{gradeType}" id="oral" name="grade_type" value="ORAL">
                <label for="oral">mündlich</label><br>

                <label for="">Name:</label>
                <input type="text" th:field="*{testName}"><br>
                <label for="">Beschreibung:</label>
                <input type="text" th:field="*{testDescription}"><br>
                <input type="submit" value="anlegen">
            </form>
        </div>
    </section>

    <section>

        <button onclick="openNewStudentWindow()">neuer Schüler</button>
        <div id="newStudent">
            <label for="">Vorname</label>
            <input type="text" id="firstName">
            <label for="">Nachname</label>
            <input type="text" id="lastName">
            <button onclick="createNewStudent()">anlegen</button>
        </div>

        <table>
            <thead>
                <tr>
                    <th rowspan="3">#</th>
                    <th rowspan="3">Vorname</th>
                    <th rowspan="3">Nachname</th>
                    <th th:unless="${#lists.isEmpty(writtenGradeTests)}" th:colspan="${#lists.size(writtenGradeTests)}" th:text="'schriftliche Noten'"></th>
                    <th th:unless="${#lists.isEmpty(oralGradeTests)}" th:colspan="${#lists.size(oralGradeTests)}" th:text="'mündliche Noten'"></th>
                </tr>
                <tr>
                    <th th:unless="${#lists.isEmpty(writtenGradeTests)}" th:each="gradeTest : ${writtenGradeTests}"
                        th:onclick="'openGradeTest(' + ${gradeTest.Id} + ')'" class="clickable" th:data-id="${gradeTest.Id}"
                        th:text="${gradeTest.testName}"></th>
                    <th th:unless="${#lists.isEmpty(oralGradeTests)}" th:each="gradeTest : ${oralGradeTests}"
                        th:onclick="'openGradeTest(' + ${gradeTest.Id} + ')'" class="clickable" th:data-id="${gradeTest.Id}"
                        th:text="${gradeTest.testName}"></th>
                </tr>
                <tr>
                    <th th:unless="${#lists.isEmpty(writtenGradeTests)}" th:each="gradeTest : ${writtenGradeTests}"
                        th:onclick="'openGradeTest(' + ${gradeTest.Id} + ')'" class="clickable" th:data-id="${gradeTest.Id}"
                        th:text="${gradeTest.testDescription}"></th>
                    <th th:unless="${#lists.isEmpty(oralGradeTests)}" th:each="gradeTest : ${oralGradeTests}"
                        th:onclick="'openGradeTest(' + ${gradeTest.Id} + ')'" class="clickable" th:data-id="${gradeTest.Id}"
                        th:text="${gradeTest.testDescription}"></th>
                </tr>
            </thead>

<!--            <th>schriftlich</th>-->
<!--            <th>mündlich</th>-->
<!--            <th>gesamt</th>-->

            <tbody th:unless="${#lists.isEmpty(students)}" th:each="student, iterStat : ${students}">
                <td th:text="${iterStat.count}"></td>
                <td th:text="${student.firstName}"></td>
                <td th:text="${student.lastName}"></td>
            </tbody>
        </table>

    </section>

<script>
$("th.clickable").hover(function() {
    $(this).addClass("coloredHeader");
    var i = $(this).index();
    var nextElem = $(this).closest("tr").next().children().eq(i);
    var prevElem =$(this).closest("tr").prev().children().eq(i)
    if( nextElem.is("th.clickable")) {
        nextElem.addClass("coloredHeader");
    }
    if( prevElem.is("th.clickable")) {
       prevElem.addClass("coloredHeader");
    }
    }, function() {
    $(this).removeClass("coloredHeader");
    var i = $(this).index();
    $(this).closest("tr").next().children().eq(i).removeClass("coloredHeader");
    $(this).closest("tr").prev().children().eq(i).removeClass("coloredHeader");
});
</script>
</body>
</html>